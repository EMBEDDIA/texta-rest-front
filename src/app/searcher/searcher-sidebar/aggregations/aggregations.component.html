<div class="wrapper">

  <ng-container *ngFor="let aggregation of aggregationList; let i = index;">
    <mat-form-field appearance="outline" class="max-width">
      <mat-label>Select Fields</mat-label>
      <mat-select panelClass="select-panel-reveal-input" [disableOptionCentering]="true"
                  [formControl]="aggregation.formControl">
        <mat-optgroup *ngFor="let group of projectFields" [label]="group.index">
          <mat-option *ngFor="let fields of group.fields" [value]="fields">
            {{fields.path}}
          </mat-option>
        </mat-optgroup>
      </mat-select>
    </mat-form-field>
    <ng-container *ngIf="fieldTypeTextOrFact(aggregation.formControl.value)">
      <app-text-aggregation [id]=i
                            [fieldsFormControl]="aggregation.formControl"
                            [aggregationObj]="aggregation">
      </app-text-aggregation>
    </ng-container>
    <ng-container *ngIf="fieldTypeDate(aggregation.formControl.value)">
      <app-date-aggregation [id]=i
                            [fieldsFormControl]="aggregation.formControl"
                            [aggregationObj]="aggregation">
      </app-date-aggregation>
    </ng-container>
  </ng-container>
  <div class="max-width">
    <button class="max-width" mat-stroked-button (click)="addNewAggregation()" [disabled]="aggregationList.length < 1">
      New Field
    </button>
  </div>

  <mat-checkbox class="exclude-search-checkbox" [(ngModel)]="searchQueryExcluded"
                labelPosition="before">Exclude current
    search:
  </mat-checkbox>

  <div class="max-width">
    <button class="max-width" mat-stroked-button (click)="aggregate()" [disabled]="aggregationList.length < 1">
      Aggregate
    </button>
  </div>
</div>
