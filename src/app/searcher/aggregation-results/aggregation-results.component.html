<div class="container">

  <div class="loading-shade" *ngIf="searchService.getIsLoading() | async">
    <mat-spinner></mat-spinner>
  </div>
  <ng-container *ngIf="aggregationData">
    <mat-tab-group mat-stretch-tabs
                   *ngIf="aggregationData.tableData !== undefined && aggregationData.tableData.length > 0">
      <mat-tab *ngFor="let tableAggregation of aggregationData.tableData" [label]="tableAggregation.name">
        <app-aggregation-result-table *ngIf="tableAggregation.tableData !== undefined"
                                      [tableData]="tableAggregation.tableData"></app-aggregation-result-table>
      </mat-tab>
    </mat-tab-group>

    <mat-tab-group mat-stretch-tabs
                   *ngIf="aggregationData.textaFactsTableData !== undefined">
      <mat-tab *ngFor="let item of aggregationData.textaFactsTableData" [label]="item.name">
        <app-aggregation-result-facts [data]="item.data"></app-aggregation-result-facts>
      </mat-tab>
    </mat-tab-group>

    <app-aggregation-results-chart
      *ngIf="aggregationData.dateData !== undefined && aggregationData.dateData.length > 0"
      [aggregationData]="aggregationData"
      [yLabel]="timeLineYLabel">

    </app-aggregation-results-chart>

    <mat-tab-group mat-stretch-tabs
                   *ngIf="aggregationData.treeData !== undefined && aggregationData.treeData.length > 0">
      <mat-tab *ngFor="let nestedAggregation of aggregationData.treeData">

        <ng-template mat-tab-label>
          {{nestedAggregation.name}}
          <button
            *ngIf="nestedAggregation !== undefined && nestedAggregation.histoBuckets!== undefined && nestedAggregation.histoBuckets.length > 0"
            mat-icon-button (click)="openUnifiedTimeline(nestedAggregation.histoBuckets)">
            <mat-icon>assessment</mat-icon>
          </button>
        </ng-template>
        <app-aggregation-results-tree [dataSource]="nestedAggregation.treeData">
        </app-aggregation-results-tree>
      </mat-tab>
    </mat-tab-group>
  </ng-container>

</div>
