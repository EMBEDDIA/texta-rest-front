<div fxLayout="row" *ngIf="user">
  <div fxFlex="50%">
    <app-project></app-project>
  </div>
  <div fxFlex="50%" class="health-wrapper">
    <div *ngIf="health" data-cy="appHomeHealth">
      <mat-card fxLayout="row wrap" fxLayoutGap="5px" class="service-status-card center-margin">
        <mat-chip-list class="center-margin" disabled>
          <mat-chip selected [color]="health.services.elastic.alive ? 'primary' : 'accent'">
            ElasticSearch {{health.services.elastic.alive ? 'ONLINE' : 'OFFLINE'}}  </mat-chip>
          <mat-chip selected [color]="health.services.mlp.alive ? 'primary' : 'accent'">
            MLP {{health.services.mlp.alive ? 'ONLINE' : 'OFFLINE'}}  </mat-chip>
          <mat-chip selected [color]="health.services.redis.alive ? 'primary' : 'accent'">
            Redis {{health.services.redis.alive ? 'ONLINE' : 'OFFLINE'}}  </mat-chip>
          <mat-chip selected color="primary"> API VERSION {{health.toolkit.version}}  </mat-chip>
          <mat-chip selected color="primary"> VERSION {{frontVersion}}  </mat-chip>
        </mat-chip-list>
      </mat-card>

      <mat-card fxLayout="row wrap" fxLayoutGap="5px" class="usage-card center-margin m-top-10">
        <div fxFlex="1 0 125px">
          <h4 class="mat-h4 center-text"> DISK SPACE </h4>
          <mat-progress-spinner
            [color]="((health.host.disk.used / health.host.disk.total) * 100) < 90 ? 'primary' : 'warn'"
            [mode]="'determinate'"
            [value]="(health.host.disk.used / health.host.disk.total) * 100"
            class="center-margin"
          >
          </mat-progress-spinner>
          <div style="position:relative; top: -60px;">
            <span class="block center-text">{{(round((health.host.disk.used / health.host.disk.total) * 100)) }}
              % </span>
          </div>
          <span class="mat-hint mat-small center-text block"> {{health.host.disk.used | number}}
            /  {{health.host.disk.total| number}} {{health.host.disk.unit}} </span>
        </div>

        <div fxFlex="1 0 125px">
          <h4 class="mat-h4 center-text">MEMORY</h4>
          <mat-progress-spinner
            [color]="((health.host.memory.used / health.host.memory.total) * 100) < 90 ? 'primary' : 'warn'"
            [mode]="'determinate'"
            [value]="(health.host.memory.used / health.host.memory.total) * 100"
            class="center-margin"
          >
          </mat-progress-spinner>
          <div style="position:relative; top: -60px;">
            <span class="block center-text">{{(round((health.host.memory.used / health.host.memory.total) * 100)) }}
              % </span>
          </div>
          <span class="mat-hint mat-small center-text block">  {{health.host.memory.used | number}}
            /  {{health.host.memory.total| number}} {{health.host.memory.unit}} </span>
        </div>

        <div fxFlex="1 0 125px">
          <h4 class="mat-h4 center-text"> CPU USAGE </h4>
          <mat-progress-spinner
            [color]="health.host.cpu.percent < 90 ? 'primary' : 'warn'"
            [mode]="'determinate'"
            [value]="health.host.cpu.percent"
            class="center-margin"
          >
          </mat-progress-spinner>
          <div style="position:relative; top: -60px">
            <span class="block center-text">{{health.host.cpu.percent}}%</span>
          </div>
        </div>
      </mat-card>


      <mat-card fxLayout="row wrap" fxLayoutGap="5px" class="counts-card center-margin">

        <div fxFlex>
          <span class="count-text center-text block"
                [ngClass]="health.host.gpu.count > 0 ? 'primary-text' : 'accent-text'">  {{health.host.gpu.count}} </span>
          <span class="mat-hint center-text block">GPUs</span>
        </div>

        <div fxFlex>
          <span class="count-text center-text block"
                [ngClass]="health.toolkit.active_tasks > 0 ? 'accent-text' : 'primary-text'">  {{health.toolkit.active_tasks}} </span>
          <span class="mat-hint center-text block">Active Tasks</span>
        </div>

      </mat-card>
    </div>
  </div>
</div>
